<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConectaServ - Cadastro Cliente</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Caminho correto -->
    <link rel="stylesheet" href="/static/img/style.css">
</head>
<body>

    <nav class="navbar navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="index.html">ConectaServ</a>
            <img src="/static/img/logo.png" alt="logo ConectaServ" class="logo">
        </div>
    </nav>

    <div class="container mt-5" style="max-width: 500px;">
        <h3 class="text-center mb-4">Cadastro de Cliente</h3>

        <!-- ÁREA PARA MENSAGENS -->
        <div id="mensagem"></div>

        <form id="form-cadastro" class="card p-4 shadow">

            <div class="mb-3">
                <label for="cad-nome" class="form-label">Nome completo</label>
                <input type="text" class="form-control" id="cad-nome" required>
            </div>

            <div class="mb-3">
                <label for="cad-email" class="form-label">E-mail</label>
                <input type="email" class="form-control" id="cad-email" required>
            </div>

            <div class="mb-3">
                <label for="cad-senha" class="form-label">Senha</label>
                <input type="password" class="form-control" id="cad-senha" required>
            </div>

            <button type="submit" class="btn btn-success w-100">Cadastrar</button>

            <p class="mt-3 text-center">
                Já tem conta?
                <a href="login_cliente.html">Faça login</a>
            </p>
        </form>
    </div>

    <footer class="rodape">
        <p>ConectaServ - Todos os direitos reservados 2025</p>
    </footer>

    <!-- Carrega o JS do cliente -->
    <script src="/static/cliente.js"></script>

    <!-- SCRIPT PARA MENSAGENS (AJUSTE NECESSÁRIO) -->
    <script>
        const form = document.getElementById("form-cadastro");
        const msgDiv = document.getElementById("mensagem");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            const nome = document.getElementById("cad-nome").value.trim();
            const email = document.getElementById("cad-email").value.trim();
            const senha = document.getElementById("cad-senha").value;

            try {
                const resposta = await fetch("/api/client/register", {
                    method: "POST",
                    headers: {"Content-Type": "application/json"},
                    body: JSON.stringify({ nome, email, senha })
                });

                const data = await resposta.json();

                if (!resposta.ok) {
                    msgDiv.innerHTML = `
                        <div class="alert alert-danger">
                            Erro ao realizar cadastro: ${data.error || "Verifique os dados."}
                        </div>`;
                    return;
                }

                msgDiv.innerHTML = `
                    <div class="alert alert-success">
                        Cadastro realizado com sucesso!
                    </div>`;

                // Limpa campos
                form.reset();

            } catch (erro) {
                msgDiv.innerHTML = `
                    <div class="alert alert-danger">
                        Erro ao conectar ao servidor. Tente novamente.
                    </div>`;
            }
        });
    </script>

</body>
</html>
